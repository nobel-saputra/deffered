<script type="module">
  import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

  const supabase = createClient("https://lrafobvtluazrwiwfbha.supabase.co", "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxyYWZvYnZ0bHVhenJ3aXdmYmhhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjEzNjMzMDEsImV4cCI6MjA3NjkzOTMwMX0.EoUY3IkcZ9jLPbGrJ6SSvRexbXKLlbrH67g7cMnk784");

  const params = new URLSearchParams(location.search);
  const target = params.get("target"); // "recipe"
  const targetId = params.get("id"); // UUID resep

  await supabase.from("deferred_links").insert({
    target,
    target_id: targetId,
  });

  document.body.innerHTML = `
    <h3>Aplikasi belum terinstall</h3>
    <p>Silakan install aplikasi untuk melihat resep.</p>
  `;
</script>
